<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/x-icon" href="Pic/icon.ico" />
    <title>Vigenère Cipher - Classical Ciphers</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="CSS/styles.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
  </head>
  <body>
    <main class="container mt-4">
      <!-- Header -->
      <div class="cipher-header mb-3">
        <h1 class="display-4"><i class="fas fa-key text-secondary me-3"></i>Vigénère Cipher</h1>
        <span class="me-3">
          <a href="#" data-bs-toggle="modal" data-bs-target="#descModal" title="Mô tả thuật toán">
            <i class="fas fa-info-circle text-info fs-3"></i>
          </a>
        </span>
        <span>
          <a href="#" data-bs-toggle="modal" data-bs-target="#extraModal" title="Thông tin bổ sung">
            <i class="fas fa-lightbulb text-warning fs-3"></i>
          </a>
        </span>
      </div>

      <!-- Modal: Mô tả thuật toán -->
      <div class="modal fade" id="descModal" tabindex="-1" aria-labelledby="descModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
          <div class="modal-content bg-detail text-dark">
            <div class="modal-header border-0">
              <h5 class="modal-title" id="descModalLabel"><i class="fas fa-info-circle text-primary me-2"></i>Mô tả thuật toán</h5>
              <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <p>Vigenère Cipher là một phương pháp mã hóa đa biểu (polyalphabetic substitution), sử dụng một từ khóa để chọn các phép dịch chuyển Caesar khác nhau cho mỗi ký tự trong văn bản gốc.</p>
              <ul class="mt-3">
                <li><strong>Lịch sử:</strong> Được mô tả lần đầu bởi Giovan Battista Bellaso vào năm 1553, nhưng lại được đặt tên theo Blaise de Vigenère.</li>
                <li><strong>Từ khóa:</strong> Một từ hoặc cụm từ được lặp lại để khớp với độ dài của văn bản gốc.</li>
                <li><strong>Loại:</strong> Mã hóa thay thế đa biểu.</li>
                <li><strong>Độ bảo mật:</strong> Cao hơn đáng kể so với mã hóa Caesar, chống lại được phương pháp phân tích tần suất đơn giản.</li>
              </ul>
              <div class="mt-3 p-3 bg-dark text-light rounded">
                <h6><i class="fas fa-graduation-cap me-2"></i>Ví dụ chi tiết:</h6>
                <div class="row">
                  <div class="col-sm-6">
                    <strong>Văn bản gốc:</strong><br />
                    <span class="text-mono">ATTACKATDAWN</span>
                  </div>
                  <div class="col-sm-6">
                    <strong>Từ khóa:</strong><br />
                    <span class="text-mono">LEMON</span>
                  </div>
                  <div class="col-12 mt-2">
                    <strong>Mã hóa:</strong><br />
                    <span class="text-mono text-primary">LXFOPVEFRNHR</span>
                  </div>
                </div>
                <hr />
                <small class="text-light">A(0) + L(11) = L(11), T(19) + E(4) = X(23), ...</small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal: Thông tin bổ sung -->
      <div class="modal fade" id="extraModal" tabindex="-1" aria-labelledby="extraModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
          <div class="modal-content bg-additional text-light">
            <div class="modal-header border-0">
              <h5 class="modal-title" id="extraModalLabel"><i class="fas fa-lightbulb text-warning me-2"></i>Thông tin bổ sung</h5>
              <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <div class="row">
                <div class="col-md-6">
                  <h6>Ưu điểm:</h6>
                  <ul>
                    <li>Chống lại phân tích tần suất đơn giản.</li>
                    <li>Bảo mật hơn nhiều so với mã hóa đơn biểu.</li>
                    <li>Khóa có thể là bất kỳ từ nào, dễ nhớ.</li>
                  </ul>
                </div>
                <div class="col-md-6">
                  <h6>Nhược điểm:</h6>
                  <ul>
                    <li>Dễ bị tấn công Kasiski và phương pháp chỉ số trùng hợp (Index of Coincidence) để tìm ra độ dài của khóa.</li>
                    <li>Khi đã biết độ dài khóa, có thể chia bản mã thành các cột và phá từng cột như mã Caesar.</li>
                  </ul>
                </div>
              </div>
              <div class="mt-3">
                <h6>Phương pháp phá mã:</h6>
                <ol>
                  <li><strong>Kasiski Examination:</strong> Tìm các chuỗi ký tự lặp lại để đoán độ dài khóa.</li>
                  <li><strong>Index of Coincidence:</strong> Phân tích thống kê để xác định độ dài khóa.</li>
                  <li><strong>Frequency Analysis (trên từng cột):</strong> Sau khi biết độ dài khóa, áp dụng phân tích tần suất cho mỗi cột.</li>
                </ol>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Tools Section -->
      <div class="row">
        <div class="col-lg-6">
          <div class="cipher-tools">
            <h4><i class="fas fa-tools text-primary me-2"></i>Công cụ mã hóa/giải mã</h4>

            <div class="form-group">
              <label for="plaintext" class="form-label">Văn bản gốc:</label>
              <textarea id="plaintext" class="form-control" rows="4" placeholder="Nhập văn bản cần xử lý...">HELLO WORLD</textarea>
            </div>

            <div class="form-group">
              <label for="keyword" class="form-label">Từ khóa (chỉ chữ cái):</label>
              <input type="text" id="keyword" class="form-control" value="LEMON"/>
            </div>

            <div class="d-flex gap-2 mb-3">
              <button class="btn btn-encrypt" onclick="encryptVigenere()"><i class="fas fa-lock me-2"></i>Mã hóa</button>
              <button class="btn btn-decrypt" onclick="decryptVigenere()"><i class="fas fa-unlock me-2"></i>Giải mã</button>
              <button class="btn btn-clear" onclick="clearAll()"><i class="fas fa-eraser me-2"></i>Xóa</button>
            </div>

            <div class="form-group">
              <label for="ciphertext" class="form-label">Kết quả:</label>
              <textarea id="ciphertext" class="form-control text-mono" rows="4" readonly placeholder="Kết quả sẽ hiển thị ở đây..."></textarea>
              <button class="btn btn-outline-info btn-sm mt-2" onclick="copyResult()"><i class="fas fa-copy me-2"></i>Sao chép</button>
              <button id="show-details-btn" type="button" class="btn btn-info btn-sm mt-2" data-bs-toggle="modal" data-bs-target="#detailsModal" disabled><i class="fas fa-search-plus me-2"></i>Xem chi tiết quá trình</button>
            </div>

            <div id="result-message" class="alert" style="display: none;"></div>
          </div>
        </div>

        <div class="col-lg-6">
          <!-- Visualization Section -->
          <div class="visualization-container">
            <h4><i class="fas fa-table text-primary me-2"></i>Bảng Vigenère (Vigenère Square)</h4>
            <p class="text-dark">Bảng chữ cái được dịch chuyển tương ứng với từng ký tự của từ khóa.</p>
            <div id="vigenere-table-container" class="text-center">
              <!-- Table will be generated by JavaScript -->
            </div>
          </div>
        </div>
      </div>
      
      <!-- Details Modal -->
      <div class="modal fade" id="detailsModal" tabindex="-1" aria-labelledby="detailsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
          <div class="modal-content bg-solution text-light">
            <div class="modal-header">
              <h5 class="modal-title" id="process-title">
                <i class="fas fa-list me-2"></i>
                <span id="process-title"></span>
              </h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-dark" id="mapping-table-modal-body">
              <!-- Detailed steps will be injected here by JavaScript -->
            </div>
          </div>
        </div>
      </div>

    </main>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="./JS/script.js"></script>
    <script src="./JS/navbar.js"></script>
    <script src="./JS/footer.js"></script>
    <script src="./JS/vigenere.js"></script>
  </body>
</html>
